<!DOCTYPE html><html><head><meta http-equiv="Content-type" content="text/html" charset="UTF-8" /><script>
$$HREPR = {
    loaded: {},
    prepare(node_id) {
        const self = document.getElementById(node_id);
        let resolve = null;
        self.__object = new Promise((rs, rj) => { resolve = rs });
        self.__object.__resolve = resolve;
        return self;
    },
    isFunc(x) {
        let hasprop = prop => Object.getOwnPropertyNames(x).includes(prop);
        return (hasprop("arguments") || !hasprop("prototype"));
    },
    allLoaded(scripts) {
        for (let script of scripts) {
            if (!$$HREPR.loaded[script]) {
                return false;
            }
        }
        return true;
    },
    loadScripts(scripts, cb) {
        if ($$HREPR.allLoaded(scripts)) {
            cb();
            return;
        }
        for (let script of scripts) {
            if ($$HREPR.loaded[script]) {
                continue;
            }
            function onLoad() {
                $$HREPR.loaded[script] = true;
                if ($$HREPR.allLoaded(scripts)) {
                    cb();
                }
            }
            let scriptTag = document.createElement("script");
            scriptTag.src = script;
            scriptTag.onload = onLoad;
            document.head.appendChild(scriptTag);
        }
    },
    ucall(obj, sym, ...arglist) {
        if (sym) {
            return $$HREPR.isFunc(obj[sym]) ? obj[sym](...arglist) : new obj[sym](...arglist);
        }
        else {
            return $$HREPR.isFunc(obj) ? obj(...arglist) : new obj(...arglist);
        }
    },
}
</script><script>
    class Counter {
        constructor(node, options) {
            this.node = node;
            this.increment = options.increment;
            this.current = 0;
            this.node.innerText = "Click me!";
            this.node.onclick = evt => {
                this.current += this.increment;
                this.node.innerText = this.current;
            }
        }
    }
    </script></head><body><div><h2>The button should show 3, 6, 9... when clicked.</h2><button style="width:100px;" id="butt">ERROR!</button></div><script>$$HREPR.prepare('butt')</script><script type="module">
const self = document.getElementById('butt');
const arglist = [self, {"increment": 3}];
let obj = $$HREPR.isFunc(Counter) ? Counter(...arglist) : new Counter(...arglist);
self.__object.__resolve(obj);
</script></body></html>